# Painel Jurídico Completo

Este é um painel administrativo completo para advogados, desenvolvido para gerenciar clientes, casos, documentos, agenda, tarefas e finanças. A aplicação é construída com HTML, CSS e JavaScript puro, utilizando o Supabase como backend para banco de dados, autenticação e armazenamento de arquivos.

## Funcionalidades

O painel oferece as seguintes funcionalidades:

*   **Autenticação de Usuários:** Login, criação de conta e logout seguros via Supabase Auth.
*   **Gestão de Clientes:** Cadastro, edição, visualização e exclusão de informações de clientes.
*   **Gestão de Casos/Processos:** Registro e acompanhamento de casos, vinculados a clientes.
*   **Gestão de Documentos:** Upload, visualização e download de documentos (PDF, Word, imagens, etc.), com armazenamento seguro no Supabase Storage.
*   **Agenda e Prazos:** Gerenciamento de eventos, audiências e prazos processuais.
*   **Controle de Tarefas:** Criação, acompanhamento e conclusão de tarefas, com prioridades e prazos.
*   **Controle Financeiro:** Registro de receitas e despesas, com resumo financeiro e histórico de lançamentos.
*   **Relatórios e Métricas:** Gráficos visuais de faturamento mensal e balanço financeiro.
*   **Casos por Cliente:** Visão organizada de todos os casos de cada cliente, com busca por nome.
*   **Indicadores de Carregamento:** Spinners visuais para melhorar a experiência do usuário durante o carregamento de dados.

## Tecnologias Utilizadas

*   **Frontend:** HTML5, CSS3, JavaScript (ES6+)
*   **Backend como Serviço (BaaS):** [Supabase](https://supabase.com) (PostgreSQL, Auth, Storage)
*   **Gráficos:** [Chart.js](https://www.chartjs.org/)
*   **Ícones:** [Font Awesome](https://fontawesome.com/)

## Configuração do Projeto

Para configurar e rodar este projeto, siga os passos abaixo:

### 1. Configuração do Supabase

1.  **Crie um Projeto Supabase:**
    *   Acesse [supabase.com](https://supabase.com) e crie uma conta gratuita.
    *   No painel, clique em "New Project".
    *   Preencha os detalhes do projeto (nome, senha do banco de dados, região).
    *   Anote o **Project URL** e a **`anon` key** (encontrados em `Project Settings > API`). Você precisará deles no `index.html`.

2.  **Crie as Tabelas do Banco de Dados:**
    *   No painel do Supabase, vá para **SQL Editor** (ícone `</>`).
    *   Clique em "+ New query" e execute o seguinte script SQL para criar todas as tabelas necessárias:

    ```sql
    -- Tabela de Clientes
    CREATE TABLE clientes (
      id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
      user_id UUID DEFAULT auth.uid() NOT NULL,
      nome TEXT NOT NULL,
      email TEXT,
      fone TEXT,
      notas TEXT,
      created_at TIMESTAMPTZ DEFAULT now()
    );

    -- Tabela de Casos
    CREATE TABLE casos (
      id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
      user_id UUID DEFAULT auth.uid() NOT NULL,
      cliente_id BIGINT REFERENCES clientes(id) ON DELETE CASCADE,
      numero TEXT NOT NULL,
      partes TEXT,
      responsavel TEXT,
      data DATE,
      status TEXT,
      created_at TIMESTANDZ DEFAULT now()
    );

    -- Tabela de Documentos
    CREATE TABLE docs (
      id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
      user_id UUID DEFAULT auth.uid() NOT NULL,
      cliente_id BIGINT REFERENCES clientes(id) ON DELETE CASCADE,
      caso_id BIGINT REFERENCES casos(id) ON DELETE SET NULL,
      titulo TEXT NOT NULL,
      nome_arquivo TEXT NOT NULL,
      path_arquivo TEXT NOT NULL, -- Caminho no Storage
      tipo_arquivo TEXT,
      data TIMESTAMPTZ DEFAULT now()
    );

    -- Tabela da Agenda
    CREATE TABLE agenda (
      id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
      user_id UUID DEFAULT auth.uid() NOT NULL,
      cliente_id BIGINT REFERENCES clientes(id) ON DELETE SET NULL,
      caso_id BIGINT REFERENCES casos(id) ON DELETE SET NULL,
      titulo TEXT NOT NULL,
      datahora TIMESTAMPTZ NOT NULL,
      status TEXT,
      descricao TEXT,
      tipo_evento TEXT,
      local TEXT,
      created_at TIMESTAMPTZ DEFAULT now()
    );

    -- Tabela de Tarefas
    CREATE TABLE tarefas (
      id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
      user_id UUID DEFAULT auth.uid() NOT NULL,
      descricao TEXT NOT NULL, -- Renomeado de 'desc' para evitar conflitos SQL
      status TEXT DEFAULT 'Pendente',
      prioridade TEXT,
      prazo_data DATE,
      cliente_id BIGINT REFERENCES clientes(id) ON DELETE SET NULL,
      caso_id BIGINT REFERENCES casos(id) ON DELETE SET NULL,
      created_at TIMESTAMPTZ DEFAULT now()
    );

    -- Tabela Financeira
    CREATE TABLE fin (
      id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
      user_id UUID DEFAULT auth.uid() NOT NULL,
      tipo TEXT NOT NULL, -- 'Receber' ou 'Pagar'
      valor REAL NOT NULL,
      data DATE NOT NULL,
      descricao TEXT NOT NULL,
      categoria TEXT,
      status_pg TEXT, -- 'Pendente', 'Pago', 'Vencido'
      cliente_id BIGINT REFERENCES clientes(id) ON DELETE SET NULL,
      caso_id BIGINT REFERENCES casos(id) ON DELETE SET NULL,
      created_at TIMESTAMPTZ DEFAULT now()
    );

    -- Habilitar Row Level Security (RLS) para segurança
    ALTER TABLE clientes ENABLE ROW LEVEL SECURITY;
    ALTER TABLE casos ENABLE ROW LEVEL SECURITY;
    ALTER TABLE docs ENABLE ROW LEVEL SECURITY;
    ALTER TABLE agenda ENABLE ROW LEVEL SECURITY;
    ALTER TABLE tarefas ENABLE ROW LEVEL SECURITY;
    ALTER TABLE fin ENABLE ROW LEVEL SECURITY;

    -- Políticas de Acesso: Usuários só podem ver/modificar seus próprios dados
    CREATE POLICY "Enable all for users based on user_id" ON clientes FOR ALL USING (auth.uid() = user_id) WITH CHECK (auth.uid() = user_id);
    CREATE POLICY "Enable all for users based on user_id" ON casos FOR ALL USING (auth.uid() = user_id) WITH CHECK (auth.uid() = user_id);
    CREATE POLICY "Enable all for users based on user_id" ON docs FOR ALL USING (auth.uid() = user_id) WITH CHECK (auth.uid() = user_id);
    CREATE POLICY "Enable all for users based on user_id" ON agenda FOR ALL USING (auth.uid() = user_id) WITH CHECK (auth.uid() = user_id);
    CREATE POLICY "Enable all for users based on user_id" ON tarefas FOR ALL USING (auth.uid() = user_id) WITH CHECK (auth.uid() = user_id);
    CREATE POLICY "Enable all for users based on user_id" ON fin FOR ALL USING (auth.uid() = user_id) WITH CHECK (auth.uid() = user_id);
    ```

3.  **Crie Funções de Banco de Dados (RPCs):**
    *   No **SQL Editor**, execute os seguintes scripts para criar as funções que o painel usa para buscar dados agregados e relatórios:

    ```sql
    CREATE OR REPLACE FUNCTION get_dashboard_counts()
    RETURNS table (
        casos_ativos bigint,
        total_clientes bigint,
        prazos_hoje bigint,
        tarefas_pendentes bigint
    )
    LANGUAGE sql
    SECURITY DEFINER
    AS $$
        select
            (select count(*) from public.casos where status = 'Ativo' and user_id = auth.uid()) as casos_ativos,
            (select count(*) from public.clientes where user_id = auth.uid()) as total_clientes,
            (select count(*) from public.agenda where date(datahora) = current_date and user_id = auth.uid()) as prazos_hoje,
            (select count(*) from public.tarefas where status = 'Pendente' and user_id = auth.uid()) as tarefas_pendentes;
    $$;

    CREATE OR REPLACE FUNCTION get_relatorio_financeiro()
    RETURNS TABLE (
        mes TEXT,
        receitas NUMERIC,
        despesas NUMERIC
    )
    LANGUAGE sql
    SECURITY DEFINER
    AS $$
        SELECT
            to_char(m.month, 'YYYY-MM') AS mes,
            COALESCE(SUM(f.valor) FILTER (WHERE f.tipo = 'Receber' AND f.status_pg = 'Pago' AND f.user_id = auth.uid()), 0) AS receitas,
            COALESCE(SUM(f.valor) FILTER (WHERE f.tipo = 'Pagar' AND f.status_pg = 'Pago' AND f.user_id = auth.uid()), 0) AS despesas
        FROM
            (SELECT date_trunc('month', generate_series(now() - interval '11 months', now(), '1 month'))::date AS month) m
        LEFT JOIN
            fin f ON date_trunc('month', f.data) = m.month
        GROUP BY
            m.month
        ORDER BY
            m.month;
    $$;

    CREATE OR REPLACE FUNCTION get_financeiro_summary()
    RETURNS TABLE (
        total_realizado NUMERIC,
        total_despesas NUMERIC,
        a_receber NUMERIC
    )
    LANGUAGE sql
    SECURITY DEFINER
    AS $$
        SELECT
            COALESCE(SUM(valor) FILTER (WHERE tipo = 'Receber' AND status_pg = 'Pago' AND user_id = auth.uid()), 0) as total_realizado,
            COALESCE(SUM(valor) FILTER (WHERE tipo = 'Pagar' AND status_pg = 'Pago' AND user_id = auth.uid()), 0) as total_despesas,
            COALESCE(SUM(valor) FILTER (WHERE tipo = 'Receber' AND status_pg = 'Pendente' AND user_id = auth.uid()), 0) as a_receber
        FROM
            public.fin;
    $$;
    ```

4.  **Crie um Bucket de Armazenamento e Políticas:**
    *   No painel do Supabase, vá para **Storage** (ícone de cilindro).
    *   Clique em "New bucket" e crie um bucket chamado `documentos`. Marque-o como **Public**.
    *   No **SQL Editor**, execute o seguinte script para definir as políticas de acesso ao Storage, permitindo que usuários autenticados gerenciem seus próprios arquivos:

    ```sql
    -- Permite que usuários LOGADOS vejam seus próprios arquivos
    CREATE POLICY "Enable read access for own files"
    ON storage.objects FOR SELECT
    USING ( auth.uid() = owner_id );

    -- Permite que usuários LOGADOS enviem novos arquivos
    CREATE POLICY "Enable insert for authenticated users"
    ON storage.objects FOR INSERT
    WITH CHECK ( auth.uid() = owner_id );

    -- Permite que usuários LOGADOS atualizem seus próprios arquivos
    CREATE POLICY "Enable update for own files"
    ON storage.objects FOR UPDATE
    USING ( auth.uid() = owner_id );

    -- Permite que usuários LOGADOS apaguem seus próprios arquivos
    CREATE POLICY "Enable delete for own files"
    ON storage.objects FOR DELETE
    USING ( auth.uid() = owner_id );
    ```

### 2. Configuração Local

1.  **Clone o Repositório:**
    ```bash
    git clone <URL_DO_SEU_REPOSITORIO>
    cd plataforma-adv # ou o nome da sua pasta
    ```

2.  **Atualize as Chaves do Supabase:**
    *   Abra o arquivo `index.html` no seu editor de código.
    *   Localize as linhas:
        ```javascript
        const SUPABASE_URL = 'https://dcznczboecepxvhpgoic.supabase.co'; // Substitua pela sua Project URL
        const SUPABASE_ANON_KEY = 'SUA_ANON_KEY_AQUI'; // Substitua pela sua anon key
        ```
    *   Substitua os valores pelos seus **Project URL** e **`anon` key** obtidos no passo 1.1.

3.  **Abra no Navegador:**
    *   Simplesmente abra o arquivo `index.html` no seu navegador preferido.

### 3. Deploy no GitHub Pages

1.  **Crie um Repositório GitHub:** Se ainda não o fez, crie um novo repositório público no GitHub.

2.  **Envie seu Código:** Faça o commit e push de todos os arquivos do seu projeto para o repositório GitHub.
    ```bash
    git add .
    git commit -m "Initial commit: Painel Jurídico Completo com Supabase"
    git push origin main # ou master, dependendo da sua branch principal
    ```

3.  **Habilite o GitHub Pages:**
    *   No seu repositório GitHub, vá para **Settings** > **Pages**.
    *   Em "Source", selecione a branch `main` (ou `master`) e a pasta `/ (root)`.
    *   Clique em "Save".
    *   Seu site estará disponível em `https://<SEU_USUARIO>.github.io/<NOME_DO_REPOSITORIO>/` (ou um domínio personalizado, se configurado).

## Como Usar

1.  **Crie uma Conta:** Ao acessar o painel pela primeira vez, clique em "Criar conta" e siga as instruções. Você precisará verificar seu e-mail.
2.  **Faça Login:** Use as credenciais criadas para acessar o painel.
3.  **Comece a Gerenciar:** Explore as diferentes abas para adicionar clientes, casos, documentos, eventos na agenda, tarefas e lançamentos financeiros.

## Contribuição

Contribuições são bem-vindas! Sinta-se à vontade para abrir issues para bugs ou sugestões, ou enviar pull requests com melhorias.

## Licença

Este projeto está licenciado sob a licença MIT. Veja o arquivo `LICENSE` para mais detalhes. (Se você não tiver um arquivo LICENSE, pode criar um ou remover esta seção.)